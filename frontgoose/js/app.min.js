function getPosition(e,t,n,o){return(e+t*n-o/2).toString()+"px"}function positionElements(){var e=$("#topBar").height(),t=$(window).height()-e,n=$(window).width(),o=document.getElementById("streamImage");o.style.maxWidth=n.toString()+"px",o.style.maxHeight=t.toString()+"px";var i=t/3,c=n/8,s=t/4,r=n/6,a=document.getElementById("upButton"),l=getPosition(0,n,7/8,c);a.style.left=l,a.style.top=getPosition(e,t,.25,i),a.style.height=i.toString()+"px",a.style.width=c.toString()+"px";var d=document.getElementById("downButton");d.style.left=l,d.style.top=getPosition(e,t,.75,i),d.style.height=i.toString()+"px",d.style.width=c.toString()+"px";var u=document.getElementById("leftButton"),g=getPosition(e,t,.75,s);u.style.left=getPosition(0,n,1/8,r),u.style.top=g,u.style.height=s.toString()+"px",u.style.width=r.toString()+"px";var m=document.getElementById("rightButton");m.style.left=getPosition(0,n,3/8,r),m.style.top=g,m.style.height=s.toString()+"px",m.style.width=r.toString()+"px";var p=document.getElementById("rotateCCWButton"),h=getPosition(e,t,.25,s);p.style.left=getPosition(0,n,1/8,r),p.style.top=h,p.style.height=s.toString()+"px",p.style.width=r.toString()+"px";var f=document.getElementById("rotateCWButton");f.style.left=getPosition(0,n,3/8,r),f.style.top=h,f.style.height=s.toString()+"px",f.style.width=r.toString()+"px"}function createImageLayer(){var e=new Image;e.style.position="absolute";var t=document.getElementById("streamImage");e.width=t.width,e.height=t.height,e.style.zIndex=-1,e.onload=imageOnload,e.src="http://192.168.1.234:8080/?action=snapshot&n="+ ++imageNumber;var n=document.getElementById("stream");n.insertBefore(e,n.firstChild)}function imageOnload(){for(this.style.zIndex=imageNumber;1<finished.length;){var e=finished.shift();e.parentNode.removeChild(e)}finished.push(this),createImageLayer()}document.body.ontouchmove=function(){event.preventDefault()},$(function(){positionElements()}),$(window).resize(function(){positionElements()}),$(document).foundation({offcanvas:{open_method:"overlap",close_on_click:!0}}),function(e,t){"function"==typeof define&&define.amd?define([],t):"undefined"!=typeof module&&module.exports?module.exports=t():e.ReconnectingWebSocket=t()}(this,function(){function e(t,n,o){function i(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}var c={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"blob"};o||(o={});for(var s in c)"undefined"!=typeof o[s]?this[s]=o[s]:this[s]=c[s];this.url=t,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var r,a=this,l=!1,d=!1,u=document.createElement("div");u.addEventListener("open",function(e){a.onopen(e)}),u.addEventListener("close",function(e){a.onclose(e)}),u.addEventListener("connecting",function(e){a.onconnecting(e)}),u.addEventListener("message",function(e){a.onmessage(e)}),u.addEventListener("error",function(e){a.onerror(e)}),this.addEventListener=u.addEventListener.bind(u),this.removeEventListener=u.removeEventListener.bind(u),this.dispatchEvent=u.dispatchEvent.bind(u),this.open=function(t){if(r=new WebSocket(a.url,n||[]),r.binaryType=this.binaryType,t){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else u.dispatchEvent(i("connecting")),this.reconnectAttempts=0;(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",a.url);var o=r,c=setTimeout(function(){(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",a.url),d=!0,o.close(),d=!1},a.timeoutInterval);r.onopen=function(n){clearTimeout(c),(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onopen",a.url),a.protocol=r.protocol,a.readyState=WebSocket.OPEN,a.reconnectAttempts=0;var o=i("open");o.isReconnect=t,t=!1,u.dispatchEvent(o)},r.onclose=function(n){if(clearTimeout(c),r=null,l)a.readyState=WebSocket.CLOSED,u.dispatchEvent(i("close"));else{a.readyState=WebSocket.CONNECTING;var o=i("connecting");o.code=n.code,o.reason=n.reason,o.wasClean=n.wasClean,u.dispatchEvent(o),t||d||((a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onclose",a.url),u.dispatchEvent(i("close")));var c=a.reconnectInterval*Math.pow(a.reconnectDecay,a.reconnectAttempts);setTimeout(function(){a.reconnectAttempts++,a.open(!0)},c>a.maxReconnectInterval?a.maxReconnectInterval:c)}},r.onmessage=function(t){(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",a.url,t.data);var n=i("message");n.data=t.data,u.dispatchEvent(n)},r.onerror=function(t){(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onerror",a.url,t),u.dispatchEvent(i("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(t){if(r)return(a.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","send",a.url,t),r.send(t);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,t){"undefined"==typeof e&&(e=1e3),l=!0,r&&r.close(e,t)},this.refresh=function(){r&&r.close()}}if("WebSocket"in window)return e.prototype.onopen=function(e){},e.prototype.onclose=function(e){},e.prototype.onconnecting=function(e){},e.prototype.onmessage=function(e){},e.prototype.onerror=function(e){},e.debugAll=!1,e.CONNECTING=WebSocket.CONNECTING,e.OPEN=WebSocket.OPEN,e.CLOSING=WebSocket.CLOSING,e.CLOSED=WebSocket.CLOSED,e});var imageNumber=0,finished=new Array;$(function(){createImageLayer()});